---
- name: Populate the nova-api database
  shell: |
    su -s /bin/sh -c "nova-manage api_db sync" nova
    su -s /bin/sh -c "nova-manage cell_v2 map_cell0" nova
    su -s /bin/sh -c "nova-manage cell_v2 create_cell --name=cell1 --verbose" nova
    su -s /bin/sh -c "nova-manage db sync" nova
  run_once: true

- name: Enable and Start Nova-api Services
  systemd:
    state: restarted
    enabled: true
    name: openstack-nova-api.service

- name: Enable and Start Nova-scheduler Services
  systemd:
    state: restarted
    enabled: true
    name: openstack-nova-scheduler.service 


- name: Enable and Start Nova-condutor Services
  systemd:
    state: restarted
    enabled: true
    name: openstack-nova-conductor.service


- name: Enable and Start Nova-novncproxy Services
  systemd:
    state: restarted
    enabled: true
    name: openstack-nova-novncproxy.service

